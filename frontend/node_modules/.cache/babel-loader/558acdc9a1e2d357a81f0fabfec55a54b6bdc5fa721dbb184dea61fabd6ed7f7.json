{"ast":null,"code":"\"use client\";\n\nvar _jsxFileName = \"F:\\\\webnox\\\\online-counseling-platform (1)\\\\frontend\\\\src\\\\contexts\\\\SocketContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useEffect, useState } from \"react\";\nimport io from \"socket.io-client\";\nimport { useAuth } from \"./AuthContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SocketContext = /*#__PURE__*/createContext();\nexport const useSocket = () => {\n  _s();\n  const context = useContext(SocketContext);\n  if (!context) {\n    throw new Error(\"useSocket must be used within a SocketProvider\");\n  }\n  return context;\n};\n_s(useSocket, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const SocketProvider = ({\n  children\n}) => {\n  _s2();\n  const [socket, setSocket] = useState(null);\n  const [connected, setConnected] = useState(false);\n  const {\n    user\n  } = useAuth();\n  useEffect(() => {\n    if (user) {\n      const newSocket = io(\"http://localhost:5000\");\n      newSocket.on(\"connect\", () => {\n        console.log(\"Connected to server\");\n        setConnected(true);\n      });\n      newSocket.on(\"disconnect\", () => {\n        console.log(\"Disconnected from server\");\n        setConnected(false);\n      });\n      setSocket(newSocket);\n      return () => {\n        newSocket.close();\n      };\n    }\n  }, [user]);\n  const joinSession = sessionId => {\n    if (socket) {\n      socket.emit(\"join-session\", sessionId);\n    }\n  };\n  const sendMessage = (sessionId, message) => {\n    if (socket) {\n      socket.emit(\"send-message\", {\n        sessionId,\n        message,\n        sender: user.id\n      });\n    }\n  };\n  const sendVideoSignal = (sessionId, signal) => {\n    if (socket) {\n      socket.emit(\"video-signal\", {\n        sessionId,\n        signal\n      });\n    }\n  };\n  const value = {\n    socket,\n    connected,\n    joinSession,\n    sendMessage,\n    sendVideoSignal\n  };\n  return /*#__PURE__*/_jsxDEV(SocketContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 10\n  }, this);\n};\n_s2(SocketProvider, \"OKPP+mnOeJfwAAivly0/xMlqf4U=\", false, function () {\n  return [useAuth];\n});\n_c = SocketProvider;\nvar _c;\n$RefreshReg$(_c, \"SocketProvider\");","map":{"version":3,"names":["_jsxFileName","_s","$RefreshSig$","_s2","createContext","useContext","useEffect","useState","io","useAuth","jsxDEV","_jsxDEV","SocketContext","useSocket","context","Error","SocketProvider","children","socket","setSocket","connected","setConnected","user","newSocket","on","console","log","close","joinSession","sessionId","emit","sendMessage","message","sender","id","sendVideoSignal","signal","value","Provider","fileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["F:/webnox/online-counseling-platform (1)/frontend/src/contexts/SocketContext.js"],"sourcesContent":["\"use client\"\n\nimport { createContext, useContext, useEffect, useState } from \"react\"\nimport io from \"socket.io-client\"\nimport { useAuth } from \"./AuthContext\"\n\nconst SocketContext = createContext()\n\nexport const useSocket = () => {\n  const context = useContext(SocketContext)\n  if (!context) {\n    throw new Error(\"useSocket must be used within a SocketProvider\")\n  }\n  return context\n}\n\nexport const SocketProvider = ({ children }) => {\n  const [socket, setSocket] = useState(null)\n  const [connected, setConnected] = useState(false)\n  const { user } = useAuth()\n\n  useEffect(() => {\n    if (user) {\n      const newSocket = io(\"http://localhost:5000\")\n\n      newSocket.on(\"connect\", () => {\n        console.log(\"Connected to server\")\n        setConnected(true)\n      })\n\n      newSocket.on(\"disconnect\", () => {\n        console.log(\"Disconnected from server\")\n        setConnected(false)\n      })\n\n      setSocket(newSocket)\n\n      return () => {\n        newSocket.close()\n      }\n    }\n  }, [user])\n\n  const joinSession = (sessionId) => {\n    if (socket) {\n      socket.emit(\"join-session\", sessionId)\n    }\n  }\n\n  const sendMessage = (sessionId, message) => {\n    if (socket) {\n      socket.emit(\"send-message\", { sessionId, message, sender: user.id })\n    }\n  }\n\n  const sendVideoSignal = (sessionId, signal) => {\n    if (socket) {\n      socket.emit(\"video-signal\", { sessionId, signal })\n    }\n  }\n\n  const value = {\n    socket,\n    connected,\n    joinSession,\n    sendMessage,\n    sendVideoSignal,\n  }\n\n  return <SocketContext.Provider value={value}>{children}</SocketContext.Provider>\n}\n"],"mappings":"AAAA,YAAY;;AAAA,IAAAA,YAAA;EAAAC,EAAA,GAAAC,YAAA;EAAAC,GAAA,GAAAD,YAAA;AAEZ,SAASE,aAAa,EAAEC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AACtE,OAAOC,EAAE,MAAM,kBAAkB;AACjC,SAASC,OAAO,QAAQ,eAAe;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAEvC,MAAMC,aAAa,gBAAGR,aAAa,CAAC,CAAC;AAErC,OAAO,MAAMS,SAAS,GAAGA,CAAA,KAAM;EAAAZ,EAAA;EAC7B,MAAMa,OAAO,GAAGT,UAAU,CAACO,aAAa,CAAC;EACzC,IAAI,CAACE,OAAO,EAAE;IACZ,MAAM,IAAIC,KAAK,CAAC,gDAAgD,CAAC;EACnE;EACA,OAAOD,OAAO;AAChB,CAAC;AAAAb,EAAA,CANYY,SAAS;AAQtB,OAAO,MAAMG,cAAc,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAd,GAAA;EAC9C,MAAM,CAACe,MAAM,EAAEC,SAAS,CAAC,GAAGZ,QAAQ,CAAC,IAAI,CAAC;EAC1C,MAAM,CAACa,SAAS,EAAEC,YAAY,CAAC,GAAGd,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM;IAAEe;EAAK,CAAC,GAAGb,OAAO,CAAC,CAAC;EAE1BH,SAAS,CAAC,MAAM;IACd,IAAIgB,IAAI,EAAE;MACR,MAAMC,SAAS,GAAGf,EAAE,CAAC,uBAAuB,CAAC;MAE7Ce,SAAS,CAACC,EAAE,CAAC,SAAS,EAAE,MAAM;QAC5BC,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC;QAClCL,YAAY,CAAC,IAAI,CAAC;MACpB,CAAC,CAAC;MAEFE,SAAS,CAACC,EAAE,CAAC,YAAY,EAAE,MAAM;QAC/BC,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;QACvCL,YAAY,CAAC,KAAK,CAAC;MACrB,CAAC,CAAC;MAEFF,SAAS,CAACI,SAAS,CAAC;MAEpB,OAAO,MAAM;QACXA,SAAS,CAACI,KAAK,CAAC,CAAC;MACnB,CAAC;IACH;EACF,CAAC,EAAE,CAACL,IAAI,CAAC,CAAC;EAEV,MAAMM,WAAW,GAAIC,SAAS,IAAK;IACjC,IAAIX,MAAM,EAAE;MACVA,MAAM,CAACY,IAAI,CAAC,cAAc,EAAED,SAAS,CAAC;IACxC;EACF,CAAC;EAED,MAAME,WAAW,GAAGA,CAACF,SAAS,EAAEG,OAAO,KAAK;IAC1C,IAAId,MAAM,EAAE;MACVA,MAAM,CAACY,IAAI,CAAC,cAAc,EAAE;QAAED,SAAS;QAAEG,OAAO;QAAEC,MAAM,EAAEX,IAAI,CAACY;MAAG,CAAC,CAAC;IACtE;EACF,CAAC;EAED,MAAMC,eAAe,GAAGA,CAACN,SAAS,EAAEO,MAAM,KAAK;IAC7C,IAAIlB,MAAM,EAAE;MACVA,MAAM,CAACY,IAAI,CAAC,cAAc,EAAE;QAAED,SAAS;QAAEO;MAAO,CAAC,CAAC;IACpD;EACF,CAAC;EAED,MAAMC,KAAK,GAAG;IACZnB,MAAM;IACNE,SAAS;IACTQ,WAAW;IACXG,WAAW;IACXI;EACF,CAAC;EAED,oBAAOxB,OAAA,CAACC,aAAa,CAAC0B,QAAQ;IAACD,KAAK,EAAEA,KAAM;IAAApB,QAAA,EAAEA;EAAQ;IAAAsB,QAAA,EAAAvC,YAAA;IAAAwC,UAAA;IAAAC,YAAA;EAAA,OAAyB,CAAC;AAClF,CAAC;AAAAtC,GAAA,CAtDYa,cAAc;EAAA,QAGRP,OAAO;AAAA;AAAAiC,EAAA,GAHb1B,cAAc;AAAA,IAAA0B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}